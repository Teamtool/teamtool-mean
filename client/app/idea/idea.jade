div(ng-include='"components/navbar/navbar.html"')

.container
  .row
    .col-lg-2
    .col-lg-8
      form.thing-form(name='form', ng-submit='addIdea(form)', novalidate='')
        label Share your ideas in realtime with your team
        .form-group(ng-class='{ "has-success": form.title.$valid && submitted, "has-error": form.title.$invalid && submitted }')
          input.form-control(type='text', name='title', placeholder='Add the title here.', ng-model='idea.title', required)
          p.help-block(ng-show='form.title.$error.required && submitted')
            | What's the title?

        .form-group(ng-class='{ "has-success": form.description.$valid && submitted, "has-error": form.description.$invalid && submitted }')
          textarea.form-control(type='textarea', name='description', placeholder='Add the description here.', ng-model='idea.description', required)
          p.help-block(ng-show='form.description.$error.required && submitted')
            | What's the description?

        .form-group(ng-class='{ "has-success": form.category.$valid && submitted, "has-error": form.category.$invalid && submitted }')
          input.form-control(type='text', style="width: 300px;", name='category', placeholder='Add the category here.', ng-model='idea.category', required)
          p.help-block(ng-show='form.category.$error.required && submitted')
            | What's the category?

        div
          button.btn.btn-primary(type='submit') Create Idea

      h1.page-header Ideas Backlog
      tabset(justified="true")
        tab(ng-repeat="state in states" heading="{{state.title}}")

          ul.nav.nav-tabs.nav-stacked(ng-repeat="idea in awesomeIdeas | filter: { state: state.value } | orderBy:'-date'")
            li(ng-class="{'to-be-rated': allowedToRate(idea)}")
              a
                .row
                  .col-md-6
                    b {{idea.name}}
                  .col-md-2
                    | {{idea.author.username}}
                  .col-md-2
                    | {{idea.category}}
                  .col-md-2(align="right")
                    .to-review(ng-show='allowedToRate(idea)')
                      rating(ng-model="idea.rating", max="5", on-leave='addRating(idea)')
                      i  {{getVotes(idea)}}
                    .reviewed(ng-show='!allowedToRate(idea)')
                      rating(ng-model="getStarAverage(idea)", max="5", readonly="true")
                      i  {{getVotes(idea)}}
                      br
                      | {{getStarAverage(idea)}} / {{getStarSum(idea)}} stars

                button.close(ng-show='allowedToDelete(idea)', type='button', ng-click='deleteIdea(idea.name, idea)')
                  span(class="glyphicon glyphicon-trash" aria-hidden="true")
                button.close(ng-show='idea.state!="implemented" && idea.state!="rejected"', type='button', ng-click='updateState("rejected", idea)')
                  span(class="glyphicon glyphicon-remove" aria-hidden="true")
                button.close(ng-show='idea.state=="open"', type='button', ng-click='updateState("accepted", idea)')
                  span(class="glyphicon glyphicon-ok" aria-hidden="true")
                button.close(ng-show='idea.state=="accepted"', type='button', ng-click='updateState("in-progress", idea)')
                  span(class="glyphicon glyphicon-play-circle" aria-hidden="true")
                button.close(ng-show='idea.state=="in-progress"', type='button', ng-click='updateState("implemented", idea)')
                  span(class="glyphicon glyphicon-check" aria-hidden="true")

                .row
                  .col-md-10
                    i.idea-description {{idea.description}}


    .col-lg-2
footer.footer
  .container
    p
      | Teamtool V0.1
      = ' | '
      a(href='https://github.com/Teamtool/teamtool-mean.git') Github
      = ' | '
      a(href='https://github.com/Teamtool/teamtool-mean/issues') Issues
